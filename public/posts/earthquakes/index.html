<!DOCTYPE html>
<html>
  <head>
    <title>Mapping Earthquakes Locations on a Map</title>
    








  



<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="/css/bootstrap.min.css"/>
<link rel="stylesheet" href="/css/layouts/main.css"/>
<link rel="stylesheet" href="/css/style.css"/>
<link rel="stylesheet" href="/css/navigators/navbar.css"/>


<link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />


<link rel="icon" type="image/png" href="/images/favicon_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_3.png" />


<link rel="stylesheet" href="/css/style.css"/>

    
<meta name="description" content="Data Visulization Using Processing.py" />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="/css/layouts/single.css"/>
<link rel="stylesheet" href="/css/navigators/sidebar.css">


    
    
  </head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    











  





  



<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="/">
      <img src="/images/main-logo_hu864bbe108f1be1ae04b57f7f2fd9d631_5637_42x0_resize_box_3.png">Ahmad Hamze Homepage</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      </ul>
    </div>
  </div>
  
  <img src="/images/main-logo_hu864bbe108f1be1ae04b57f7f2fd9d631_5637_42x0_resize_box_3.png" class="d-none" id="main-logo">
  <img src="/images/inverted-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_42x0_resize_box_3.png" class="d-none" id="inverted-logo">
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <input type="text" value="" placeholder="Search" data-search="" id="search-box" />
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="/posts" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
  
    
    <li><a class="" href="/posts/estimating-pi/">Monte-Carlo Estimation of Pi</a></li>
  

  
  
  
  
    
    
  
  
    
    <li><a class="active" href="/posts/earthquakes/">Mapping Earthquakes Locations on a Map</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/pictionary/">Pictionary using websockets</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/c&#43;&#43;-matrix/">Simple C&#43;&#43; matrix calculation</a></li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/algorithmics/">Algorithmics Blogs</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/algorithmics/memoization/">Recursion with Memoization</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/automation/">Automation Programs</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/automation/puppeteer-vs-selenium/">Puppeteer vs Selenium</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/automation/selenium-speed-test/">Selenium Speed Test</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/opinion/">Opinion Blogs</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/opinion/advice-to-myself/">Advice to my past self</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/opinion/first-react-job/">Web Dev Learned Lessons</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="/posts/react/">React Applications</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="/posts/react/trivia-quiz/">React Trivia Quiz</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="/posts/react/storybook-trivia-quiz/">Storybook with React</a></li>
  


      </ul>
    </li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(http://AhmadHamze.github.io/posts/earthquakes/hero.png);'>
      </div>

      
      <div class="page-content">
        <div class="author-profile ml-auto align-self-lg-center">
          <img class="rounded-circle" src='/images/my-photo.jpg'/>
          <h5 class="author-name">Ahmad Hamze</h5>
          <p>October 18, 2021</p>
        </div>

        <div class="title">
          <h1>Mapping Earthquakes Locations on a Map</h1>
        </div>

        <div class="post-content" id="post-content">
          <h2 id="introduction">Introduction</h2>
<p>This is a data visualization program made using <a href="https://processing.org/">processing.py</a>, I made it a few years ago, however, I think it&rsquo;s a great program that deserves recognition.</p>
<p>You can find the code and the data used <a href="https://github.com/AhmadHamze/Earthquakes-">here</a>.</p>
<h2 id="data">Data</h2>
<p>The program uses a csv file containing 2000 locations of earthquakes (longitude and latitude), the magnitude of the earthquakes, and the name of the place where they occurred (a string). Here is the source of the <a href="https://earthquake.usgs.gov">data</a></p>
<p><img src="images/csv_file.png" alt="csv file"></p>
<p>Also, an equirectangular map of the earth is needed, this is where the locations will be ploted.</p>
<p><img src="images/map.png" alt="world map"></p>
<h2 id="code">Code</h2>
<p>We will discuss the code briefly, mainly the points that I find most interesting.</p>
<h3 id="saving-the-picture-on-a-pdf-file">Saving the picture on a pdf file</h3>
<p>The output of the program will be a pdf file displaying the final image, to do that we need to use a processing library that deals with pdf files.<br>
The first line of the program calls the library: <code>add_library('pdf')</code>.</p>
<p>The next step is to specify the size of the image, I chose <code>size(1400,700)</code>,
then we call <code>beginRecord(PDF,&quot;Earthquakes.pdf&quot;)</code> to save the work on a new &ldquo;Earthquakes.pdf&rdquo; file, and stop saving at the end of the program by calling <code>endRecord()</code>.</p>
<p>Just after <code>beginRecord</code>, we have to load the image we&rsquo;re using and create the shape of the final map.
We want the map to be drawn from the top left corner of the screen and occupy all the available width and height.
this is exactly what <code>shape(loadShape(&quot;WorldMap.svg&quot;),0,0,width,height)</code> does.</p>
<blockquote>
<p>Note that <em>width</em> and <em>height</em> are automatic variables which are always defined as being the values entered in &ldquo;size(.., ..)&rdquo;</p>
</blockquote>
<h3 id="parsing-the-csv-file">Parsing the csv file</h3>
<p>First, we open the csv file using a context manager <code>with open(&quot;EarthquakeData.csv&quot;,'r') as csv_file:</code>.<br>
Next, we will be making use of <code>csv.DictReader</code> to parse the csv file, this is a powerful function that returns an ordered dictionary for every line in the csv file.
The data in each line contains each data field as a value to its corresponding field name which will be a key of the dictionary.</p>
<p><code>csv_reader = csv.DictReader(csv_file)</code></p>
<p>Finaly, start looping <code>for i,li_ne in enumerate(csv_reader):</code></p>
<h3 id="the-map-function">The map function</h3>
<p>This is the most crucial function in the program, it&rsquo;s a processing function that allows translating the set of data into a map.
It takes a value that exists on one scale and maps this value on a different scale.</p>
<p>For example, if you want the longitude 125.5 to be mapped on a map having a certain width, this is what you need to do:</p>
<p><code>map(125.5, -180, 180, 0, width)</code></p>
<p>The original scale here is -180:180 with 0 as its center.</p>
<h3 id="drawing">Drawing</h3>
<p>Back to the main code:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> <span style="color:#66d9ef">for</span> i,li_ne <span style="color:#f92672">in</span> enumerate(csv_reader):
        graphLong <span style="color:#f92672">=</span> map(float(li_ne[<span style="color:#e6db74">&#34;longitude&#34;</span>]),<span style="color:#f92672">-</span><span style="color:#ae81ff">180</span>,<span style="color:#ae81ff">180</span>,<span style="color:#ae81ff">0</span>,width)
        graphLat <span style="color:#f92672">=</span> map(float(li_ne[<span style="color:#e6db74">&#34;latitude&#34;</span>]),<span style="color:#f92672">-</span><span style="color:#ae81ff">90</span>,<span style="color:#ae81ff">90</span>,height,<span style="color:#ae81ff">0</span>)
        magnitude <span style="color:#f92672">=</span> sqrt((float(li_ne[<span style="color:#e6db74">&#34;mag&#34;</span>])<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span>)<span style="color:#f92672">/</span>PI)
        <span style="color:#66d9ef">if</span> i <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">3</span>:
            fill(<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">50</span>)
            ellipse(graphLong,graphLat,<span style="color:#ae81ff">20</span><span style="color:#f92672">*</span>magnitude,<span style="color:#ae81ff">20</span><span style="color:#f92672">*</span>magnitude)
            fill(<span style="color:#ae81ff">0</span>)
            text(li_ne[<span style="color:#e6db74">&#34;place&#34;</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">+</span>li_ne[<span style="color:#e6db74">&#34;mag&#34;</span>] <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;Richter&#34;</span>,graphLong<span style="color:#f92672">-</span><span style="color:#ae81ff">150</span>,graphLat)
        <span style="color:#66d9ef">else</span>:
            fill(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">255</span>,<span style="color:#ae81ff">50</span>)
            ellipse(graphLong,graphLat,<span style="color:#ae81ff">5</span><span style="color:#f92672">*</span>magnitude,<span style="color:#ae81ff">5</span><span style="color:#f92672">*</span>magnitude)
</code></pre></div><p>As you can see, we&rsquo;re using the &ldquo;enumerate&rdquo; function to be able to access each line of data. The first three earthquakes have a different color than the rest, also a text is displayed next to each one of the three showing the magnitude and the
name of the place where the earthquake occurred.</p>
<blockquote>
<p><em>magnitude</em> is built in such a way that when used to draw a circle using it as a radius, you would get a disk of area magnitude / 2. This is unnecessary because the magnitude values are very small and no effect will be noticed.</p>
</blockquote>
<h2 id="result">Result</h2>
<p>Running the code will produce a pdf file containing this image.</p>
<p><img src="images/earthquakes.png" alt="result"></p>

        </div>

        
        
          <div class="btn-improve-page">
              <a href="https://github.com/AhmadHamze/AhmadHamze.github.io.git/edit//content/posts/earthquakes/index.md">
                <i class="fas fa-code-branch"></i>
                Improve this page
              </a>
          </div>
        

        
      <hr />
        <div class="row next-prev-navigator">


  

  

  

  

  

  
    
      
      <div class="col-md-6 previous-article">
        <a href="/posts/react/trivia-quiz/" class="btn btn-outline-info">
          <span><i class="fas fa-chevron-circle-left"></i> Prev</span>
          <br />
          <span>A React Typescript Trivia Quiz</span>
        </a>
      </div>
      
    
    
      
        
        
          
              
          
        
        <div class="col-md-6 next-article">
          <a href="/posts/pictionary/" class="btn btn-outline-info">
            <span>Next <i class="fas fa-chevron-circle-right"></i></span>
            <br />
            <span>A live pictionary using websockets</span>
          </a>
        </div>
      
    
  

  

  

  

  

  

</div>

      <hr />
      
      
      </div>
    </div>
  </div>
  
</section>


      
      
  <section class="toc-section" id="toc-section">
    
  </section>

    </div>

    

  




  




  
  
    
  









  







<footer class="container-fluid text-center align-content-center footer pb-2">
  <div class="container pt-5">
    <div class="row text-left">
      <div class="col-md-4 col-sm-12">
        <h5>Navigation</h5>
        
        <ul>
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#About">About me</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#Skills">Skills</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#projects">Projects</a>
              </li>
            
            
              
              
                
              
              <li class="nav-item">
                <a class="smooth-scroll" href="#recent-posts">Blogs</a>
              </li>
            
        </ul>
        

      </div>
      
      <div class="col-md-4 col-sm-12">
        <h5>Contact me:</h5>
        <ul>
          
          <li><span>Email: </span> <span>ahmadhamze@yahoo.com</span></li>
          
        </ul>
      </div>
      
      
    </div>
  </div>
  <hr />
  <div class="container">
    <div class="row text-left">
      <div class="col-md-4">
        <a id="theme" href="https://github.com/hossainemruz/toha" target="#">
          <img src="/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png">
          Toha
        </a>
      </div>
      <div class="col-md-4 text-center">Â© 2021 Copyright.</div>
      <div class="col-md-4 text-right">
        <a id="hugo" href="https://gohugo.io/">Powered by
        <img
          src="/images/hugo-logo.svg"
          alt="Hugo Logo"
          height="18"
        />
        </a>
      </div>
    </div>
  </div>
</footer>

    <script src="/js/jquery-3.4.1.min.js"></script>
<script src="/js/popper.min.js"></script>
<script src="/js/bootstrap.min.js"></script>

<script src="/js/navbar.js"></script>
<script src="/js/main.js"></script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="/js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>


  </body>
</html>
